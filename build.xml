<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project name="Vitry" basedir="." default="debug">

	<description>
Vitry

A music composition environment

This program is free software, see COPYING.txt for details.
ABSOLUTELY NO WARRANTY IMPLIED.
	</description>

	<property name="javascriptVersion" value="180"/>
    <property name="src.js"            value="src/js"/>


    <!-- =============================================================== -->
	<target name="clean" description="">
        <delete dir="bin" failonerror="false" />
	</target>

    <!-- =============================================================== -->
	<target name="dirs">
	    <mkdir dir="bin"/>
	</target>

	<!-- =============================================================== -->
	<target name="jsc" description="">
		<!-- TODO use some fancy property operation to factor
		out common code -->

        <java fork="true"
		    classpath="lib/js.jar:lib/jline.jar:bin"
		    classname="org.mozilla.javascript.tools.jsc.Main"
		    failonerror="true">
	        <arg value="-d"/>
            <arg value="bin"/>
	        <arg value="-nosource"/>
	        <arg value="-opt"/>
	        <arg value="0"/>
            <arg value="-version"/>
	        <arg value="${javascriptVersion}"/>
            <arg value="-package"/>
            <arg value="vitry"/>

            <arg value="${src.js}/vitry/core.js"/>
            <arg value="${src.js}/vitry/header.js"/>
            <arg value="${src.js}/vitry/main.js"/>
            <arg value="${src.js}/vitry/music.js"/>
            <arg value="${src.js}/vitry/readers.js"/>
            <arg value="${src.js}/vitry/writers.js"/>
            <arg value="${src.js}/vitry/util.js"/>
		</java>

        <!--
        <java fork="true"
            classpath="lib/js.jar:lib/jline.jar:bin"
            classname="org.mozilla.javascript.tools.jsc.Main"
            failonerror="true">

            <arg value="-d"/>
            <arg value="bin"/>
            <arg value="-nosource"/>
            <arg value="-opt"/>
            <arg value="0"/>
            <arg value="-version"/>
            <arg value="${javascriptVersion}"/>
            <arg value="-package"/>
            <arg value="vitry.util"/>

            <arg value="${src.js}/vitry/util/javascript.js"/>
        </java>
        -->
	</target>

    <!-- =============================================================== -->
    <target name="javac" description="">
        <javac srcdir="src" destdir="bin" extdirs="">
            <classpath>
                <pathelement location="lib/js.jar" />
                <pathelement location="lib/jline.jar" />
            </classpath>
        </javac>
	</target>

    <!-- =============================================================== -->
	<target name="jar">
		<jar destfile="vitry.jar" description="">
			<fileset dir="bin">
				<filename name="**/*" />
			</fileset>
		</jar>
	</target>

	<!-- =============================================================== -->
	<target name="debug" depends="clean, dirs, javac, jsc" description="">
	</target>

   <!-- =============================================================== -->
    <target name="usage" description="">
        <echo>Usage: ant release</echo>
        <echo>       ant debug</echo>
        <echo>       ant -p for help</echo>
    </target>

</project>